<!doctype html><html lang=en><head><meta charset=UTF-8><meta content="default-src 'self';font-src 'self' data:;img-src 'self' https://* data:;media-src 'self';style-src 'self';frame-src player.vimeo.com https://www.youtube-nocookie.com;connect-src 'self' rylie.goatcounter.com/count 'self' https://*;script-src 'self' gc.zgo.at 'self'" http-equiv=Content-Security-Policy><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://rylie.moe name=base><title>
PicoCTF 2024: Forensics | lumi's trashcan</title><link href=https://rylie.moe/favicon.ico rel=icon type=image/png><link title="lumi's trashcan - Atom Feed" href=https://rylie.moe/atom.xml rel=alternate type=application/atom+xml><link href="https://rylie.moe/custom_subset.css?h=0b9535a28bc3d5bf2321" rel=stylesheet><link href="https://rylie.moe/main.css?h=9ba37545587e359ed117" rel=stylesheet><link href="https://rylie.moe/skins/sakura.css?h=2d9c69af51135683e3bd" rel=stylesheet><meta content="light dark" name=color-scheme><meta content="my thoughts and rants." name=description><meta content="my thoughts and rants." property=og:description><meta content="PicoCTF 2024: Forensics" property=og:title><meta content=article property=og:type><meta content=en_GB property=og:locale><meta content=https://rylie.moe/blog/picoctf-2024-forensics/ property=og:url><meta content="lumi's trashcan" property=og:site_name><noscript><link href=https://rylie.moe/no_js.css rel=stylesheet></noscript><script src=https://rylie.moe/js/initializeTheme.min.js></script><script defer src=https://rylie.moe/js/themeSwitcher.min.js></script><script async data-goatcounter=https://rylie.goatcounter.com/count src=https://gc.zgo.at/count.js></script><script src="https://rylie.moe/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e" defer></script><body><header><nav class=navbar><div class=nav-title><a class=home-title href=https://rylie.moe>lumi's trashcan</a></div><div class=nav-navs><ul><li><a class="nav-links no-hover-padding" href=https://rylie.moe/blog/>blog </a><li><a class="nav-links no-hover-padding" href=https://rylie.moe/archive/>archive </a><li><a class="nav-links no-hover-padding" href=https://rylie.moe/tags/>tags </a><li><a class="nav-links no-hover-padding" href=https://rylie.moe/projects/>projects </a><li class=menu-icons-container><ul class=menu-icons-group><li class="js menu-icon"><div aria-label="Click or press $SHORTCUT to open search" class="search-icon interactive-icon" title="Click or press $SHORTCUT to open search" id=search-button role=button tabindex=0><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="M784-120 532-372q-30 24-69 38t-83 14q-109 0-184.5-75.5T120-580q0-109 75.5-184.5T380-840q109 0 184.5 75.5T640-580q0 44-14 83t-38 69l252 252-56 56ZM380-400q75 0 127.5-52.5T560-580q0-75-52.5-127.5T380-760q-75 0-127.5 52.5T200-580q0 75 52.5 127.5T380-400Z"/></svg></div><li class="theme-switcher-wrapper js"><div aria-label="Toggle dark mode" title="Toggle dark/light mode" aria-pressed=false class=theme-switcher role=button tabindex=0></div><div aria-label="Reset mode to default" class="theme-resetter arrow" title="Reset mode to default" aria-hidden=true role=button tabindex=0></div></ul></ul></div></nav></header><div class=content><main><article><h1 class=article-title>PicoCTF 2024: Forensics</h1><ul class=meta><li>1st Aug 2024<li title="1083 words"><span aria-hidden=true class=separator>|</span>6 min read<li class=tag><span aria-hidden=true class=separator>|</span>Tags: <li class=tag><a href=https://rylie.moe/tags/picoctf/>picoctf</a>, <li class=tag><a href=https://rylie.moe/tags/coding/>coding</a>, <li class=tag><a href=https://rylie.moe/tags/ctf/>ctf</a>, <li class=tag><a href=https://rylie.moe/tags/forensics/>forensics</a></ul><div class=toc-container><h3>Table of Contents</h3><ul><li><a href=https://rylie.moe/blog/picoctf-2024-forensics/#verify>Verify</a><li><a href=https://rylie.moe/blog/picoctf-2024-forensics/#scan-surprise>Scan Surprise</a><li><a href=https://rylie.moe/blog/picoctf-2024-forensics/#secret-of-the-polyglot>Secret of the Polyglot</a><li><a href=https://rylie.moe/blog/picoctf-2024-forensics/#canyousee>CanYouSee</a><li><a href=https://rylie.moe/blog/picoctf-2024-forensics/#blast-from-the-past>Blast from the past</a><li><a href=https://rylie.moe/blog/picoctf-2024-forensics/#mob-psycho>Mob psycho</a><li><a href=https://rylie.moe/blog/picoctf-2024-forensics/#endianess-v2>endianess-v2</a></ul></div><section class=body><p>I have had interest in cyber security and CTF-related stuff for a while now, but I’ve never had the time to properly learn them. Given that <a class=external href=https://ctf.sekai.team>SekaiCTF 2024</a> is starting soon, and my planned ideas edging closer to things related in this field, I will be trying to prepare for it and spend some time learning more about it! Thanks to Bottersnike’s recommendations, I started doing <a class=external href=https://picoctf.org>PicoCTF’s</a> backlog of challenges to have a better grasp at this! In this post, I will be giving writeups for the forensics challenges as I go through them.<blockquote><p>This blogpost will describe the challenges and give the solutions to them - but I will not be giving out the flag in its entirety.</blockquote><h1 id=verify><a aria-label="Anchor link for: verify" class="header-anchor no-hover-padding" href=#verify><span aria-hidden=true class=link-icon></span></a> Verify</h1><blockquote><p><strong>Difficulty</strong>: Easy <br> <strong>Categories</strong>: grep, checksum</blockquote><p>In this challenge, you’re given a folder of encrypted files, the decryption script and the SHA-256 hash of the file you’re looking for. On a Linux machine, it’s a simple run of <code>sha256sum</code> on all the files in the folder, and <code>grep</code>ping for the given SHA-256 hash. Afterwards, running the decryption script on the file would give you the flag you’re looking for.<h1 id=scan-surprise><a aria-label="Anchor link for: scan-surprise" class="header-anchor no-hover-padding" href=#scan-surprise><span aria-hidden=true class=link-icon></span></a> Scan Surprise</h1><blockquote><p><strong>Difficulty</strong>: Easy <br> <strong>Categories</strong>: shell, qrcode</blockquote><p>As the name suggests, the challenge gives you a QR code. Simply scan the QR code using your mobile device, or convert it to text using just about any QR code to text converter, and you’re good to go.<h1 id=secret-of-the-polyglot><a aria-label="Anchor link for: secret-of-the-polyglot" class="header-anchor no-hover-padding" href=#secret-of-the-polyglot><span aria-hidden=true class=link-icon></span></a> Secret of the Polyglot</h1><blockquote><p><strong>Difficulty</strong>: Easy <br> <strong>Categories</strong>: file_format, polyglot</blockquote><p>The challenge gives you a <code>.pdf</code> file. Attempting to open this file as-is gives you… half a flag? Where’s the other part? Using <code>file</code> on the downloaded file gives you this:<pre class=z-code><code><span class="z-text z-plain">$ file flag2of2-final.pdf
</span><span class="z-text z-plain">flag2of2-final.pdf: PNG image data, 50 x 50, 8-bit/color RGBA, non-interlaced
</span></code></pre><p>Hmm, that’s weird. Let’s try making it a PNG file and see what happens. Changing the file extension to <code>.png</code> and opening it with an image viewer yields the other half of the flag, and we’re done!<blockquote><p>Loupe (GNOME’s image viewer) gave me a hard time doing this - it kept recognizing the ending half of the file as <code>application/pdf</code> and refused to open the file, despite it having a <code>PNG</code> header and file extension. I had to download GIMP to open the file up to see the first half of the flag.</blockquote><h1 id=canyousee><a aria-label="Anchor link for: canyousee" class="header-anchor no-hover-padding" href=#canyousee><span aria-hidden=true class=link-icon></span></a> CanYouSee</h1><blockquote><p><strong>Difficulty</strong>: Easy <br> <strong>Categories</strong>: none</blockquote><p>This challenge gives you a <code>.zip</code> file, which contains a <code>.jpg</code> image inside. Opening the image doesn’t <em>really</em> show anything that’s irregular - no signs of steganography, at least, to the naked eye. Maybe there’s something in the metadata? Using <code>exiftool</code> on the extracted <code>.jpg</code> gives us this:<pre class=z-code><code><span class="z-text z-plain">$ exiftool ukn_reality.jpg
</span><span class="z-text z-plain">ExifTool Version Number         : 12.92
</span><span class="z-text z-plain">File Name                       : ukn_reality.jpg
</span><span class="z-text z-plain">Directory                       : .
</span><span class="z-text z-plain">File Size                       : 2.3 MB
</span><span class="z-text z-plain">File Modification Date/Time     : 2024:03:12 07:05:53+07:00
</span><span class="z-text z-plain">File Access Date/Time           : 2024:03:12 07:05:53+07:00
</span><span class="z-text z-plain">File Inode Change Date/Time     : 2024:08:01 18:15:46+07:00
</span><span class="z-text z-plain">File Permissions                : -rw-r--r--
</span><span class="z-text z-plain">File Type                       : JPEG
</span><span class="z-text z-plain">File Type Extension             : jpg
</span><span class="z-text z-plain">MIME Type                       : image/jpeg
</span><span class="z-text z-plain">JFIF Version                    : 1.01
</span><span class="z-text z-plain">Resolution Unit                 : inches
</span><span class="z-text z-plain">X Resolution                    : 72
</span><span class="z-text z-plain">Y Resolution                    : 72
</span><span class="z-text z-plain">XMP Toolkit                     : Image::ExifTool 11.88
</span><span class="z-text z-plain">Attribution URL                 : cGljb0NURntNRTc0RDQ3QV9ISUREM05fYjMyMDQwYjh9Cg==
</span><span class="z-text z-plain">Image Width                     : 4308
</span><span class="z-text z-plain">Image Height                    : 2875
</span><span class="z-text z-plain">Encoding Process                : Baseline DCT, Huffman coding
</span><span class="z-text z-plain">Bits Per Sample                 : 8
</span><span class="z-text z-plain">Color Components                : 3
</span><span class="z-text z-plain">Y Cb Cr Sub Sampling            : YCbCr4:2:0 (2 2)
</span><span class="z-text z-plain">Image Size                      : 4308x2875
</span><span class="z-text z-plain">Megapixels                      : 12.4
</span></code></pre><p>Ooh, the attribution URL looks interesting. That’s a base64 encoded string! Let’s try decoding this! There are many ways to do it, but I use Linux’s <code>base64</code> utility as such:<pre class=z-code><code><span class="z-text z-plain">$ echo "cGljb0NURntNRTc0RDQ3QV9ISUREM05fYjMyMDQwYjh9Cg==" | base64 -d
</span></code></pre><p>That gives us the flag for the challenge!<h1 id=blast-from-the-past><a aria-label="Anchor link for: blast-from-the-past" class="header-anchor no-hover-padding" href=#blast-from-the-past><span aria-hidden=true class=link-icon></span></a> Blast from the past</h1><blockquote><p><strong>Difficulty</strong>: Medium <br> <strong>Categories</strong>: metadata</blockquote><p>An image is given by the challenge, and your task is to set all the timestamps to <code>1970:01:01 00:00:00.001+00:00</code> (that’s one millisecond after the start of the Unix epoch!) with as much precision as possible. Using <code>exiftool</code> once again, we can set the majority of the dates using <code>exiftool "-AllDates=1970:01:01 00:00:00.001+00:00" original.jpg</code>. This comes with its downside - the subsecond creation date, original date/time and modify date will be off in the milliseconds. Once again, use <code>exiftool</code> to change those dates to match the precise timestamp. After this, submit the file to the checker program.<p>We’ve obtained the flag, that’s done– Until we haven’t. You will see one last timestamp tag that we’ll need to set - the Samsung: TimeStamp tag. This pesky timestamp is not writable through <code>exiftool</code>, so we’ll need another tool for the job. But, just to be sure, let’s run the file through <code>exiftool</code> one last time, but this time we’ll increase the verbosity all the way up.<pre class=z-code><code><span class="z-text z-plain">$ exiftool -v3 original.jpg
</span><span class="z-text z-plain"># a whole lot of metadata omitted...
</span><span class="z-text z-plain">Samsung trailer (143 bytes at offset 0x2b83ca):
</span><span class="z-text z-plain">  2b83ca: 00 00 01 0a 0e 00 00 00 49 6d 61 67 65 5f 55 54 [........Image_UT]
</span><span class="z-text z-plain">  2b83da: 43 5f 44 61 74 61 31 37 30 30 35 31 33 31 38 31 [C_Data1700513181]
</span><span class="z-text z-plain">  2b83ea: 34 32 30 00 00 a1 0a 08 00 00 00 4d 43 43 5f 44 [420........MCC_D]
</span><span class="z-text z-plain">  2b83fa: 61 74 61 33 31 30 00 00 61 0c 18 00 00 00 43 61 [ata310..a.....Ca]
</span><span class="z-text z-plain">  2b840a: 6d 65 72 61 5f 43 61 70 74 75 72 65 5f 4d 6f 64 [mera_Capture_Mod]
</span><span class="z-text z-plain">  2b841a: 65 5f 49 6e 66 6f 31 53 45 46 48 6b 00 00 00 03 [e_Info1SEFHk....]
</span><span class="z-text z-plain">  2b842a: 00 00 00 00 00 01 0a 57 00 00 00 23 00 00 00 00 [.......W...#....]
</span><span class="z-text z-plain">  2b843a: 00 a1 0a 34 00 00 00 13 00 00 00 00 00 61 0c 21 [...4.........a.!]
</span><span class="z-text z-plain">  2b844a: 00 00 00 21 00 00 00 30 00 00 00 53 45 46 54    [...!...0...SEFT]
</span><span class="z-text z-plain">  SamsungTrailer_0x0a01Name = Image_UTC_Data
</span><span class="z-text z-plain">  - Tag '0x0a01-name' (14 bytes):
</span><span class="z-text z-plain">    2b83d2: 49 6d 61 67 65 5f 55 54 43 5f 44 61 74 61       [Image_UTC_Data]
</span><span class="z-text z-plain">  TimeStamp = 1700513181420
</span><span class="z-text z-plain">  - Tag '0x0a01' (13 bytes):
</span><span class="z-text z-plain">    2b83e0: 31 37 30 30 35 31 33 31 38 31 34 32 30          [1700513181420]
</span><span class="z-text z-plain">  SamsungTrailer_0x0aa1Name = MCC_Data
</span><span class="z-text z-plain">  - Tag '0x0aa1-name' (8 bytes):
</span><span class="z-text z-plain">    2b83f5: 4d 43 43 5f 44 61 74 61                         [MCC_Data]
</span><span class="z-text z-plain">  MCCData = 310
</span><span class="z-text z-plain">  - Tag '0x0aa1' (3 bytes):
</span><span class="z-text z-plain">    2b83fd: 33 31 30                                        [310]
</span><span class="z-text z-plain">  SamsungTrailer_0x0c61Name = Camera_Capture_Mode_Info
</span><span class="z-text z-plain">  - Tag '0x0c61-name' (24 bytes):
</span><span class="z-text z-plain">    2b8408: 43 61 6d 65 72 61 5f 43 61 70 74 75 72 65 5f 4d [Camera_Capture_M]
</span><span class="z-text z-plain">    2b8418: 6f 64 65 5f 49 6e 66 6f                         [ode_Info]
</span><span class="z-text z-plain">  SamsungTrailer_0x0c61 = 1
</span><span class="z-text z-plain">  - Tag '0x0c61' (1 bytes):
</span><span class="z-text z-plain">    2b8420: 31                                              [1]
</span></code></pre><p>Oooh, we’re seeing something! The Samsung: TimeStamp tag is stored in the file under hex - and it’s simply the Unix timestamp in milliseconds! Using any hex editor - I use GHex for simplicity’s sake, find the bytes shown in <code>exiftool</code>’s output: <code>31 37 30 30 35 31 33 31 38 31 34 32 30</code>, and edit it to be <code>30 30 30 30 30 30 30 30 30 30 30 30 31</code>, which is what we need the timestamp to be. Submitting the file one final time, and we’re <em>finally</em> done with this one.<h1 id=mob-psycho><a aria-label="Anchor link for: mob-psycho" class="header-anchor no-hover-padding" href=#mob-psycho><span aria-hidden=true class=link-icon></span></a> Mob psycho</h1><blockquote><p><strong>Difficulty</strong>: Medium <br> <strong>Categories</strong>: apk</blockquote><p>An <code>.apk</code> file. We all know these are glorified <code>.zip</code> files. Let’s <code>unzip</code> this, and see what’s inside. Unzipping the given APK, there’s nothing <em>too</em> out of the ordinary for this directory structure. Everything is there, everything looks fine, so far nothing too special.<p>I am not going to scroll through and go into each directory to find files, so I’ll just run a simple <code>find</code> in the directory. Scrolling through the results and… “<code>./res/color/flag.txt</code>? Is this it? Printing out the file content gives what looks like a hexadecimal string. Let’s run this through a hexadecimal to ASCII converter aaaaand… there’s our flag!<h1 id=endianess-v2><a aria-label="Anchor link for: endianess-v2" class="header-anchor no-hover-padding" href=#endianess-v2><span aria-hidden=true class=link-icon></span></a> endianess-v2</h1><blockquote><p><strong>Difficulty</strong>: Medium <br> <strong>Categories</strong>: none</blockquote><p>The challenge gives us another weird file. Running <code>file</code> gives nothing, and it doesn’t look like anything opens it up correctly either. It’s time to take a look at it once again in a hex editor. GHex gives me a very interesting first line… <code>E0 FF D8 FF 46 4A 10 00 01 00 46 49 01 00 00 00</code>, the ASCII representation of which is <code>....FJ....FI....</code>. Wait… Isn’t this the JFIF header but flipped? It looks like every four bytes is flipped around, if you compare it to the correct JFIF header: <code>FF D8 FF E0 .. .. 4A 46 49 46 00 ..</code> (of which <code>..</code> is some hex value). The block of <code>E0 FF D8 FF</code> is reversed, and so on for every other chunk of 4 bytes.<p>I guess it’s time for a Python script or something, as rewriting this by hand is… basically impossible.<pre class="language-python z-code" data-lang=python><code class=language-python data-lang=python><span class="z-source z-python"><span class="z-meta z-statement z-import z-python"><span class="z-keyword z-control z-import z-python">import</span> <span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">binascii</span></span></span>
</span><span class="z-source z-python">
</span><span class="z-source z-python"><span class="z-comment z-line z-number-sign z-python"><span class="z-punctuation z-definition z-comment z-python">#</span> open the files
</span></span><span class="z-source z-python"><span class="z-meta z-statement z-with z-python"><span class="z-keyword z-control z-flow z-with z-python">with</span> <span class="z-meta z-function-call z-python"><span class="z-meta z-qualified-name z-python"><span class="z-variable z-function z-python"><span class="z-support z-function z-builtin z-python">open</span></span></span></span><span class="z-meta z-function-call z-arguments z-python"><span class="z-punctuation z-section z-arguments z-begin z-python">(</span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-punctuation z-definition z-string z-begin z-python">"</span></span></span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python">challengefile<span class="z-punctuation z-definition z-string z-end z-python">"</span></span></span><span class="z-punctuation z-separator z-arguments z-python">,</span> <span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-punctuation z-definition z-string z-begin z-python">"</span></span></span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python">rb<span class="z-punctuation z-definition z-string z-end z-python">"</span></span></span><span class="z-punctuation z-section z-arguments z-end z-python">)</span></span> <span class="z-meta z-statement z-with z-python"><span class="z-keyword z-control z-flow z-with z-as z-python">as</span></span></span><span class="z-meta z-statement z-with z-python"> <span class="z-meta z-generic-name z-python">original_file</span><span class="z-punctuation z-section z-block z-with z-python">:</span></span>
</span><span class="z-source z-python">    <span class="z-meta z-statement z-with z-python"><span class="z-keyword z-control z-flow z-with z-python">with</span> <span class="z-meta z-function-call z-python"><span class="z-meta z-qualified-name z-python"><span class="z-variable z-function z-python"><span class="z-support z-function z-builtin z-python">open</span></span></span></span><span class="z-meta z-function-call z-arguments z-python"><span class="z-punctuation z-section z-arguments z-begin z-python">(</span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-punctuation z-definition z-string z-begin z-python">"</span></span></span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python">solution<span class="z-punctuation z-definition z-string z-end z-python">"</span></span></span><span class="z-punctuation z-separator z-arguments z-python">,</span> <span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-punctuation z-definition z-string z-begin z-python">"</span></span></span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python">wb<span class="z-punctuation z-definition z-string z-end z-python">"</span></span></span><span class="z-punctuation z-section z-arguments z-end z-python">)</span></span> <span class="z-meta z-statement z-with z-python"><span class="z-keyword z-control z-flow z-with z-as z-python">as</span></span></span><span class="z-meta z-statement z-with z-python"> <span class="z-meta z-generic-name z-python">new_file</span><span class="z-punctuation z-section z-block z-with z-python">:</span></span>
</span><span class="z-source z-python">        <span class="z-comment z-line z-number-sign z-python"><span class="z-punctuation z-definition z-comment z-python">#</span> read the original file and get the hex values
</span></span><span class="z-source z-python">        <span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">hex_data</span></span> <span class="z-keyword z-operator z-assignment z-python">=</span> <span class="z-meta z-function-call z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">original_file</span></span><span class="z-meta z-qualified-name z-python"><span class="z-punctuation z-accessor z-dot z-python">.</span></span><span class="z-meta z-qualified-name z-python"><span class="z-variable z-function z-python"><span class="z-meta z-generic-name z-python">read</span></span></span></span><span class="z-meta z-function-call z-arguments z-python"><span class="z-punctuation z-section z-arguments z-begin z-python">(</span><span class="z-punctuation z-section z-arguments z-end z-python">)</span></span><span class="z-meta z-function-call z-python"><span class="z-meta z-qualified-name z-python"><span class="z-punctuation z-accessor z-dot z-python">.</span></span><span class="z-meta z-qualified-name z-python"><span class="z-variable z-function z-python"><span class="z-meta z-generic-name z-python">hex</span></span></span></span><span class="z-meta z-function-call z-arguments z-python"><span class="z-punctuation z-section z-arguments z-begin z-python">(</span><span class="z-punctuation z-section z-arguments z-end z-python">)</span></span>
</span><span class="z-source z-python">
</span><span class="z-source z-python">        <span class="z-comment z-line z-number-sign z-python"><span class="z-punctuation z-definition z-comment z-python">#</span> create an array of 4-byte blocks
</span></span><span class="z-source z-python">        <span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">hex_array</span></span> <span class="z-keyword z-operator z-assignment z-python">=</span> <span class="z-meta z-sequence z-list z-python"><span class="z-punctuation z-section z-sequence z-begin z-python">[</span><span class="z-meta z-item-access z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">hex_data</span></span></span><span class="z-meta z-item-access z-python"><span class="z-punctuation z-section z-brackets z-begin z-python">[</span></span><span class="z-meta z-item-access z-arguments z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">i</span></span><span class="z-punctuation z-separator z-slice z-python">:</span><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">i</span></span><span class="z-keyword z-operator z-arithmetic z-python">+</span><span class="z-constant z-numeric z-integer z-decimal z-python">8</span></span><span class="z-meta z-item-access z-python"><span class="z-punctuation z-section z-brackets z-end z-python">]</span></span> <span class="z-meta z-expression z-generator z-python"><span class="z-keyword z-control z-loop z-for z-generator z-python">for</span> <span class="z-meta z-generic-name z-python">i</span> <span class="z-keyword z-control z-loop z-for z-in z-python">in</span></span> <span class="z-meta z-function-call z-python"><span class="z-meta z-qualified-name z-python"><span class="z-variable z-function z-python"><span class="z-support z-function z-builtin z-python">range</span></span></span></span><span class="z-meta z-function-call z-arguments z-python"><span class="z-punctuation z-section z-arguments z-begin z-python">(</span><span class="z-constant z-numeric z-integer z-decimal z-python">0</span><span class="z-punctuation z-separator z-arguments z-python">,</span> <span class="z-meta z-function-call z-python"><span class="z-meta z-qualified-name z-python"><span class="z-variable z-function z-python"><span class="z-support z-function z-builtin z-python">len</span></span></span></span><span class="z-meta z-function-call z-arguments z-python"><span class="z-punctuation z-section z-arguments z-begin z-python">(</span><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">hex_data</span></span><span class="z-punctuation z-section z-arguments z-end z-python">)</span></span><span class="z-punctuation z-separator z-arguments z-python">,</span> <span class="z-constant z-numeric z-integer z-decimal z-python">8</span><span class="z-punctuation z-section z-arguments z-end z-python">)</span></span><span class="z-punctuation z-section z-sequence z-end z-python">]</span></span>
</span><span class="z-source z-python">
</span><span class="z-source z-python">        <span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">reversed_array</span></span> <span class="z-keyword z-operator z-assignment z-python">=</span> <span class="z-meta z-sequence z-list z-empty z-python"><span class="z-punctuation z-section z-sequence z-begin z-python">[</span><span class="z-punctuation z-section z-sequence z-end z-python">]</span></span>
</span><span class="z-source z-python">
</span><span class="z-source z-python">        <span class="z-comment z-line z-number-sign z-python"><span class="z-punctuation z-definition z-comment z-python">#</span> create an array with all the reversed strings
</span></span><span class="z-source z-python">        <span class="z-meta z-statement z-loop z-for z-python"><span class="z-keyword z-control z-loop z-for z-python">for</span> <span class="z-meta z-generic-name z-python">hex_string</span> <span class="z-keyword z-control z-loop z-for z-in z-python">in</span></span><span class="z-meta z-statement z-loop z-for z-python"> <span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">hex_array</span></span></span><span class="z-meta z-statement z-loop z-for z-python"><span class="z-punctuation z-section z-block z-loop z-for z-python">:</span></span>
</span><span class="z-source z-python">            <span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">reversed_hex_string</span></span> <span class="z-keyword z-operator z-assignment z-python">=</span> <span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-punctuation z-definition z-string z-begin z-python">"</span></span></span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-punctuation z-definition z-string z-end z-python">"</span></span></span><span class="z-meta z-function-call z-python"><span class="z-meta z-qualified-name z-python"><span class="z-punctuation z-accessor z-dot z-python">.</span></span><span class="z-meta z-qualified-name z-python"><span class="z-variable z-function z-python"><span class="z-meta z-generic-name z-python">join</span></span></span></span><span class="z-meta z-function-call z-arguments z-python"><span class="z-punctuation z-section z-arguments z-begin z-python">(</span><span class="z-meta z-function-call z-python"><span class="z-meta z-qualified-name z-python"><span class="z-variable z-function z-python"><span class="z-support z-function z-builtin z-python">reversed</span></span></span></span><span class="z-meta z-function-call z-arguments z-python"><span class="z-punctuation z-section z-arguments z-begin z-python">(</span><span class="z-meta z-sequence z-list z-python"><span class="z-punctuation z-section z-sequence z-begin z-python">[</span><span class="z-meta z-item-access z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">hex_string</span></span></span><span class="z-meta z-item-access z-python"><span class="z-punctuation z-section z-brackets z-begin z-python">[</span></span><span class="z-meta z-item-access z-arguments z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">i</span></span><span class="z-punctuation z-separator z-slice z-python">:</span><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">i</span></span><span class="z-keyword z-operator z-arithmetic z-python">+</span><span class="z-constant z-numeric z-integer z-decimal z-python">2</span></span><span class="z-meta z-item-access z-python"><span class="z-punctuation z-section z-brackets z-end z-python">]</span></span> <span class="z-meta z-expression z-generator z-python"><span class="z-keyword z-control z-loop z-for z-generator z-python">for</span> <span class="z-meta z-generic-name z-python">i</span> <span class="z-keyword z-control z-loop z-for z-in z-python">in</span></span> <span class="z-meta z-function-call z-python"><span class="z-meta z-qualified-name z-python"><span class="z-variable z-function z-python"><span class="z-support z-function z-builtin z-python">range</span></span></span></span><span class="z-meta z-function-call z-arguments z-python"><span class="z-punctuation z-section z-arguments z-begin z-python">(</span><span class="z-constant z-numeric z-integer z-decimal z-python">0</span><span class="z-punctuation z-separator z-arguments z-python">,</span> <span class="z-meta z-function-call z-python"><span class="z-meta z-qualified-name z-python"><span class="z-variable z-function z-python"><span class="z-support z-function z-builtin z-python">len</span></span></span></span><span class="z-meta z-function-call z-arguments z-python"><span class="z-punctuation z-section z-arguments z-begin z-python">(</span><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">hex_string</span></span><span class="z-punctuation z-section z-arguments z-end z-python">)</span></span><span class="z-punctuation z-separator z-arguments z-python">,</span> <span class="z-constant z-numeric z-integer z-decimal z-python">2</span><span class="z-punctuation z-section z-arguments z-end z-python">)</span></span><span class="z-punctuation z-section z-sequence z-end z-python">]</span></span><span class="z-punctuation z-section z-arguments z-end z-python">)</span></span><span class="z-punctuation z-section z-arguments z-end z-python">)</span></span>
</span><span class="z-source z-python">            <span class="z-meta z-function-call z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">reversed_array</span></span><span class="z-meta z-qualified-name z-python"><span class="z-punctuation z-accessor z-dot z-python">.</span></span><span class="z-meta z-qualified-name z-python"><span class="z-variable z-function z-python"><span class="z-meta z-generic-name z-python">append</span></span></span></span><span class="z-meta z-function-call z-arguments z-python"><span class="z-punctuation z-section z-arguments z-begin z-python">(</span><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">reversed_hex_string</span></span><span class="z-punctuation z-section z-arguments z-end z-python">)</span></span>
</span><span class="z-source z-python">
</span><span class="z-source z-python">        <span class="z-comment z-line z-number-sign z-python"><span class="z-punctuation z-definition z-comment z-python">#</span> join it all together
</span></span><span class="z-source z-python">        <span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">reversed_string</span></span> <span class="z-keyword z-operator z-assignment z-python">=</span> <span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-punctuation z-definition z-string z-begin z-python">"</span></span></span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-punctuation z-definition z-string z-end z-python">"</span></span></span><span class="z-meta z-function-call z-python"><span class="z-meta z-qualified-name z-python"><span class="z-punctuation z-accessor z-dot z-python">.</span></span><span class="z-meta z-qualified-name z-python"><span class="z-variable z-function z-python"><span class="z-meta z-generic-name z-python">join</span></span></span></span><span class="z-meta z-function-call z-arguments z-python"><span class="z-punctuation z-section z-arguments z-begin z-python">(</span><span class="z-meta z-sequence z-list z-python"><span class="z-punctuation z-section z-sequence z-begin z-python">[</span><span class="z-meta z-item-access z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">reversed_array</span></span></span><span class="z-meta z-item-access z-python"><span class="z-punctuation z-section z-brackets z-begin z-python">[</span></span><span class="z-meta z-item-access z-arguments z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">i</span></span></span><span class="z-meta z-item-access z-python"><span class="z-punctuation z-section z-brackets z-end z-python">]</span></span> <span class="z-meta z-expression z-generator z-python"><span class="z-keyword z-control z-loop z-for z-generator z-python">for</span> <span class="z-meta z-generic-name z-python">i</span> <span class="z-keyword z-control z-loop z-for z-in z-python">in</span></span> <span class="z-meta z-function-call z-python"><span class="z-meta z-qualified-name z-python"><span class="z-variable z-function z-python"><span class="z-support z-function z-builtin z-python">range</span></span></span></span><span class="z-meta z-function-call z-arguments z-python"><span class="z-punctuation z-section z-arguments z-begin z-python">(</span><span class="z-constant z-numeric z-integer z-decimal z-python">0</span><span class="z-punctuation z-separator z-arguments z-python">,</span> <span class="z-meta z-function-call z-python"><span class="z-meta z-qualified-name z-python"><span class="z-variable z-function z-python"><span class="z-support z-function z-builtin z-python">len</span></span></span></span><span class="z-meta z-function-call z-arguments z-python"><span class="z-punctuation z-section z-arguments z-begin z-python">(</span><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">reversed_array</span></span><span class="z-punctuation z-section z-arguments z-end z-python">)</span></span><span class="z-punctuation z-section z-arguments z-end z-python">)</span></span><span class="z-punctuation z-section z-sequence z-end z-python">]</span></span><span class="z-punctuation z-section z-arguments z-end z-python">)</span></span>
</span><span class="z-source z-python">
</span><span class="z-source z-python">        <span class="z-comment z-line z-number-sign z-python"><span class="z-punctuation z-definition z-comment z-python">#</span> write it out to the file
</span></span><span class="z-source z-python">        <span class="z-meta z-statement z-loop z-for z-python"><span class="z-keyword z-control z-loop z-for z-python">for</span> <span class="z-meta z-generic-name z-python">i</span> <span class="z-keyword z-control z-loop z-for z-in z-python">in</span></span><span class="z-meta z-statement z-loop z-for z-python"> <span class="z-meta z-function-call z-python"><span class="z-meta z-qualified-name z-python"><span class="z-variable z-function z-python"><span class="z-support z-function z-builtin z-python">range</span></span></span></span><span class="z-meta z-function-call z-arguments z-python"><span class="z-punctuation z-section z-arguments z-begin z-python">(</span><span class="z-constant z-numeric z-integer z-decimal z-python">0</span><span class="z-punctuation z-separator z-arguments z-python">,</span> <span class="z-meta z-function-call z-python"><span class="z-meta z-qualified-name z-python"><span class="z-variable z-function z-python"><span class="z-support z-function z-builtin z-python">len</span></span></span></span><span class="z-meta z-function-call z-arguments z-python"><span class="z-punctuation z-section z-arguments z-begin z-python">(</span><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">reversed_string</span></span><span class="z-punctuation z-section z-arguments z-end z-python">)</span></span><span class="z-punctuation z-separator z-arguments z-python">,</span> <span class="z-constant z-numeric z-integer z-decimal z-python">2</span><span class="z-punctuation z-section z-arguments z-end z-python">)</span></span></span><span class="z-meta z-statement z-loop z-for z-python"><span class="z-punctuation z-section z-block z-loop z-for z-python">:</span></span>
</span><span class="z-source z-python">            <span class="z-meta z-function-call z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">new_file</span></span><span class="z-meta z-qualified-name z-python"><span class="z-punctuation z-accessor z-dot z-python">.</span></span><span class="z-meta z-qualified-name z-python"><span class="z-variable z-function z-python"><span class="z-meta z-generic-name z-python">write</span></span></span></span><span class="z-meta z-function-call z-arguments z-python"><span class="z-punctuation z-section z-arguments z-begin z-python">(</span><span class="z-meta z-function-call z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">binascii</span></span><span class="z-meta z-qualified-name z-python"><span class="z-punctuation z-accessor z-dot z-python">.</span></span><span class="z-meta z-qualified-name z-python"><span class="z-variable z-function z-python"><span class="z-meta z-generic-name z-python">unhexlify</span></span></span></span><span class="z-meta z-function-call z-arguments z-python"><span class="z-punctuation z-section z-arguments z-begin z-python">(</span><span class="z-meta z-item-access z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">reversed_string</span></span></span><span class="z-meta z-item-access z-python"><span class="z-punctuation z-section z-brackets z-begin z-python">[</span></span><span class="z-meta z-item-access z-arguments z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">i</span></span><span class="z-punctuation z-separator z-slice z-python">:</span><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">i</span></span><span class="z-keyword z-operator z-arithmetic z-python">+</span><span class="z-constant z-numeric z-integer z-decimal z-python">2</span></span><span class="z-meta z-item-access z-python"><span class="z-punctuation z-section z-brackets z-end z-python">]</span></span><span class="z-punctuation z-section z-arguments z-end z-python">)</span></span><span class="z-punctuation z-section z-arguments z-end z-python">)</span></span>
</span></code></pre><p>Not the cleanest Python code, I know. A quick check with <code>file</code> shows that we’ve got the file correctly:<pre class=z-code><code><span class="z-text z-plain">$ file solution
</span><span class="z-text z-plain">solution: JPEG image data, JFIF standard 1.01, aspect ratio, density 1x1, segment length 16, baseline, precision 8, 300x150, components 3
</span></code></pre><p>And opening it would result in our flag!<blockquote><p>There remains one more challenge unsolved - and that’s Dear Diary - a disk image challenge. As of writing this post right now (August 1, 2024) I am too lazy to really go look at it, so this would be all my solutions for now. Thanks a ton to making through to the end!</blockquote></section></article></main><div id=button-container><div id=toc-floating-container><input class=toggle id=toc-toggle type=checkbox><label class=overlay for=toc-toggle></label><label title="Toggle Table of Contents" class=button for=toc-toggle id=toc-button><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="M414.82-193.094q-18.044 0-30.497-12.32-12.453-12.319-12.453-30.036t12.453-30.086q12.453-12.37 30.497-12.37h392.767q17.237 0 29.927 12.487 12.69 12.486 12.69 30.203 0 17.716-12.69 29.919t-29.927 12.203H414.82Zm0-244.833q-18.044 0-30.497-12.487Q371.87-462.9 371.87-480.45t12.453-29.92q12.453-12.369 30.497-12.369h392.767q17.237 0 29.927 12.511 12.69 12.512 12.69 29.845 0 17.716-12.69 30.086-12.69 12.37-29.927 12.37H414.82Zm0-245.167q-18.044 0-30.497-12.32t-12.453-30.037q0-17.716 12.453-30.086 12.453-12.369 30.497-12.369h392.767q17.237 0 29.927 12.486 12.69 12.487 12.69 30.203 0 17.717-12.69 29.92-12.69 12.203-29.927 12.203H414.82ZM189.379-156.681q-32.652 0-55.878-22.829t-23.226-55.731q0-32.549 23.15-55.647 23.151-23.097 55.95-23.097 32.799 0 55.313 23.484 22.515 23.484 22.515 56.246 0 32.212-22.861 54.893-22.861 22.681-54.963 22.681Zm0-245.167q-32.652 0-55.878-23.134-23.226-23.135-23.226-55.623 0-32.487 23.467-55.517t56.12-23.03q32.102 0 54.721 23.288 22.62 23.288 22.62 55.775 0 32.488-22.861 55.364-22.861 22.877-54.963 22.877Zm-.82-244.833q-32.224 0-55.254-23.288-23.03-23.289-23.03-55.623 0-32.333 23.271-55.364 23.272-23.03 55.495-23.03 32.224 0 55.193 23.288 22.969 23.289 22.969 55.622 0 32.334-23.21 55.364-23.21 23.031-55.434 23.031Z"/></svg></label><div class=toc-content><div class=toc-container><ul><li><a href=https://rylie.moe/blog/picoctf-2024-forensics/#verify>Verify</a><li><a href=https://rylie.moe/blog/picoctf-2024-forensics/#scan-surprise>Scan Surprise</a><li><a href=https://rylie.moe/blog/picoctf-2024-forensics/#secret-of-the-polyglot>Secret of the Polyglot</a><li><a href=https://rylie.moe/blog/picoctf-2024-forensics/#canyousee>CanYouSee</a><li><a href=https://rylie.moe/blog/picoctf-2024-forensics/#blast-from-the-past>Blast from the past</a><li><a href=https://rylie.moe/blog/picoctf-2024-forensics/#mob-psycho>Mob psycho</a><li><a href=https://rylie.moe/blog/picoctf-2024-forensics/#endianess-v2>endianess-v2</a></ul></div></div></div><a title="Go to the top of the page" class=no-hover-padding href=# id=top-button> <svg viewbox="0 0 20 20" fill=currentColor><path d="M3.293 9.707a1 1 0 010-1.414l6-6a1 1 0 011.414 0l6 6a1 1 0 01-1.414 1.414L11 5.414V17a1 1 0 11-2 0V5.414L4.707 9.707a1 1 0 01-1.414 0z"/></svg> </a></div><span class=hidden id=copy-success> Copied! </span><span class=hidden id=copy-init> Copy code to clipboard </span><script defer src=https://rylie.moe/js/copyCodeToClipboard.min.js></script></div><footer><section><nav class="socials nav-navs"><ul><li><a class="nav-links no-hover-padding social" href=https://rylie.moe/atom.xml> <img alt=feed loading=lazy src=https://rylie.moe/social_icons/rss.svg title=feed> </a><li><a class="nav-links no-hover-padding social" rel=" me" href=https://github.com/j1nxie> <img alt=github loading=lazy src=https://rylie.moe/social_icons/github.svg title=github> </a><li><a class="nav-links no-hover-padding social" rel=" me" href=https://steamcommunity.com/id/cauvong-chan> <img alt=steam loading=lazy src=https://rylie.moe/social_icons/steam.svg title=steam> </a><li><a class="nav-links no-hover-padding social" rel=" me" href=https://anilist.co/user/Lumi9> <img alt=anilist loading=lazy src=https://rylie.moe/social_icons/anilist.svg title=anilist> </a></ul></nav><nav class=nav-navs><small> <ul><li><a class="nav-links no-hover-padding" href=https://rylie.moe/sitemap.xml> sitemap </a></ul> </small></nav><div class=credits><small> <p><p>lumi’s trashcan © 2022-2025 lumi</p> Powered by <a href=https://www.getzola.org>Zola</a> & <a href=https://github.com/welpo/tabi>tabi</a> </small></div></section><div class="search-modal js" aria-labelledby=modalTitle id=searchModal role=dialog><h1 class=visually-hidden id=modalTitle>Search</h1><div id=modal-content><div id=searchBar><div aria-hidden=true class=search-icon><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="M784-120 532-372q-30 24-69 38t-83 14q-109 0-184.5-75.5T120-580q0-109 75.5-184.5T380-840q109 0 184.5 75.5T640-580q0 44-14 83t-38 69l252 252-56 56ZM380-400q75 0 127.5-52.5T560-580q0-75-52.5-127.5T380-760q-75 0-127.5 52.5T200-580q0 75 52.5 127.5T380-400Z"/></svg></div><input aria-controls=results-container aria-expanded=false autocomplete=off id=searchInput placeholder=Search… role=combobox spellcheck=false><div class="close-icon interactive-icon" title="Clear search" id=clear-search role=button tabindex=0><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg></div></div><div id=results-container><div id=results-info><span id=zero_results> No results</span><span id=one_results> $NUMBER result</span><span id=many_results> $NUMBER results</span><span id=two_results> $NUMBER results</span><span id=few_results> $NUMBER results</span></div><div id=results role=listbox></div></div></div></div></footer>